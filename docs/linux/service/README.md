# 服务

## 1. 服务和分类

### 1.1 运行级别

#### 1.1.1 运行级别分类

| 运行级别 | 含义                                                                         |
| -------- | ---------------------------------------------------------------------------- |
| 0 关机   |
| 1        | 单用户,类似于 Window 的安全模式，主要用于系统修复                            |
| 2        | 不完全多用户，类似于字符界面，但不包含 NFS(Linux 和 Window 进行文件共享)服务 |
| 3        | 完整的命令行模式，就是标准的字符界面                                         |
| 4        | 系统保留未使用                                                               |
| 5        | 图形界面                                                                     |
| 5        | 图形界面                                                                     |
| 6        | 重启                                                                         |

#### 1.1.2 查看上一个级别和当前级别

```bash
runlevel
3 5
```

#### 1.1.3 切换运行级别

```bash
init 5
```

#### 1.1.4 设置默认运行级别

```bash
vi /etc/inittab
id:3:initdefault:
```

### 1.2 服务的分类

- 系统开启的服务越少，服务器就会更加稳定和安全
- 服务安装方式不同，启动的方式也不同

#### 1.2.1 服务管理的方式

- RPM 包安装的服务,由软件包作者指定安装位置,独立的服务，绝大多数服务都是独立运行在内存中的，可以直接响应客户端的请求
- 源码包安装的服务，由我们用户决定安装位置

#### 1.2.2 查看 RPM 包安装的服务

```bash
chkconfig --list
```

#### 1.2.3 查看源码包安装的服务

- 查看自定义的安装位置，默认为/usr/local 下
- usr= Unix System Resource 系统资源

#### 1.2.4 启动和自启动

- 启动服务就是指让此服务在当前系统中运行，并向客户端提供服务
- 服务自启动就是指通过设置，让此服务在开机或者重启后随着系统启动而自动启动

### 1.3 服务与端口

- 查看系统中的运行中的进程

```bash
ps -aux
```

- 查看常见服务端口

```bash
cat /etc/services
```

### 1.4 查询系统中监听的端口

- netstat -tulnp

| 参数 | 含义                           |
| ---- | ------------------------------ |
| -t   | 列出 tcp 数据                  |
| -u   | 列出 udp 数据                  |
| -l   | 列出正在监听的网络服务         |
| -n   | 用端口号来显示服务，而非服务名 |
| -p   | 列出该服务的进程 ID            |

## 2. PRM 包服务管理

- RMP 是 LINUX 下的一种软件的可执行程序，你只要安装它就可以了。这种软件安装包通常是一个 RPM 包（Redhat Linux Packet Manager，就是 Redhat 的包管理器），后缀是.rpm
- RPM 是 Red Hat 公司随 Redhat Linux 推出了一个软件包管理器，通过它能够更加轻松容易地实现软件的安装

### 2.1 rpm 命令

| 命令                               | 含义                                                                                       |
| ---------------------------------- | ------------------------------------------------------------------------------------------ |
| 安装软件                           | 执行 rpm -ivh rpm 包名 其中 i 表示安装 install，v 表示显示安装过程 verbose，h 表示显示进度 |
| 升级软件                           | 执行 rpm -Uvh rpm 包名 U 表示升级 update                                                   |
| 反安装                             | 执行 rpm -e rpm 包名                                                                       |
| 查询软件包的详细信息               | 执行 rpm -qpi rpm 包名                                                                     |
| 查询某个文件是属于那个 rpm 包的    | 执行 rpm -qf rpm 包名                                                                      |
| 查该软件包会向系统里面写入哪些文件 | 执行 rpm -qpl rpm 包名                                                                     |

### 2.2 repo

- repo 文件是 yum 源（软件仓库）的配置文件，通常一个 repo 文件定义了一个或者多个软件仓库的细节内容，例如我们将从哪里下载需要安装或者升级的软件包，repo 文件中的设置内容将被 yum 读取和应用
- 服务器端：在服务器上面存放了所有的 RPM 软件包，然后以相关的功能去分析每个 RPM 文件的依赖性关系，将这些数据记录成文件存放在服务器的某特定目录内。
- 客户端：如果需要安装某个软件时，先下载服务器上面记录的依赖性关系文件(可通过 WWW 或 FTP 方式)，通过对服务器端下载的纪录数据进行分析，然后取得所有相关的软件，一次全部下载下来进行安装。

```bash
cat /etc/yum.conf
/etc/yum.repos.d
/etc/yum.repos.d/nginx.repo
```
