(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{202:function(t,s,a){"use strict";a.r(s);var v=a(6),_=Object(v.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"进程管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进程管理"}},[t._v("#")]),t._v(" 进程管理")]),t._v(" "),a("ul",[a("li",[t._v("进程是正在执行的一个程序或命令，每一个进程都是一个运行的实体，都有自己的地址空间并且用一定的系统资源")]),t._v(" "),a("li",[t._v("进程就是正在执行的某个程序")])]),t._v(" "),a("h2",{attrs:{id:"_1-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),a("ul",[a("li",[t._v("判断服务器的状态")]),t._v(" "),a("li",[t._v("查看系统中的所有进程")]),t._v(" "),a("li",[t._v("杀死进程，只有无法关闭才要杀死进程")])]),t._v(" "),a("h2",{attrs:{id:"_1-2-进程的查看命令-ps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-进程的查看命令-ps"}},[t._v("#")]),t._v(" 1.2 进程的查看命令(ps)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ps aux")]),t._v(" 查看系统中所有进程，使用 BSD 操作系统格式")]),t._v(" "),a("li",[a("code",[t._v("ps -le")]),t._v(" 查看系统中所有进程，使用 Linux 标准格式")]),t._v(" "),a("li",[t._v("TTY 是 TeleType 的一个缩写，原来指的是电传打字机，是通过串行线用打印机键盘通过阅读和发送信息的东西")]),t._v(" "),a("li",[t._v("pts(pseudo['su:doʊ]-terminal slave)是所谓的伪终端或虚拟终端")])]),t._v(" "),a("h3",{attrs:{id:"_1-2-1-选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-选项"}},[t._v("#")]),t._v(" 1.2.1 选项")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("-a")]),t._v(" "),a("td",[t._v("显示一个终端的所有进程")])]),t._v(" "),a("tr",[a("td",[t._v("-u")]),t._v(" "),a("td",[t._v("显示进程的归属用户及内存的使用情况")])]),t._v(" "),a("tr",[a("td",[t._v("-x")]),t._v(" "),a("td",[t._v("显示没有控制终端的进程")])]),t._v(" "),a("tr",[a("td",[t._v("-l")]),t._v(" "),a("td",[t._v("长格式显示，显示更详细的信息")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-2-2-打印字段含义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-打印字段含义"}},[t._v("#")]),t._v(" 1.2.2 打印字段含义")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("数据")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("USER")]),t._v(" "),a("td",[t._v("该进程是由哪个用户创建的")])]),t._v(" "),a("tr",[a("td",[t._v("PID")]),t._v(" "),a("td",[t._v("进程的 ID 号")])]),t._v(" "),a("tr",[a("td",[t._v("%CPU")]),t._v(" "),a("td",[t._v("该进程占用 CPU 资源的百分比，占用越高说明越消耗系统资源")])]),t._v(" "),a("tr",[a("td",[t._v("%MEM")]),t._v(" "),a("td",[t._v("该进程占用物理内存的百分比，占用越高说明越消耗系统资源")])]),t._v(" "),a("tr",[a("td",[t._v("VSZ")]),t._v(" "),a("td",[t._v("该进程占用虚拟内存的百分比，单位是 KB")])]),t._v(" "),a("tr",[a("td",[t._v("RSS")]),t._v(" "),a("td",[t._v("该进程占用实际物理内存大小，单位是 KB")])]),t._v(" "),a("tr",[a("td",[t._v("TTY")]),t._v(" "),a("td",[t._v("该进程在哪个终端中运行。tty1~tty7 表示本地控制终端，tty1~tty6 是字符终端，tty7 是图形终端。pts/0~255 代表虚拟终端，?表示此终端是系统启动的")])]),t._v(" "),a("tr",[a("td",[t._v("STAT")]),t._v(" "),a("td",[t._v("进程状态")])]),t._v(" "),a("tr",[a("td",[t._v("START")]),t._v(" "),a("td",[t._v("该进程的启动时间")])]),t._v(" "),a("tr",[a("td",[t._v("TIME")]),t._v(" "),a("td",[t._v("该进程占用 CPU 的运算时间,数值越高说明越消耗系统资源")])]),t._v(" "),a("tr",[a("td",[t._v("COMMAND")]),t._v(" "),a("td",[t._v("产生此进程的命令名")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-2-3-stat-进程状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-stat-进程状态"}},[t._v("#")]),t._v(" 1.2.3 STAT 进程状态")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("R(Runing)")]),t._v(" "),a("td",[t._v("运行")])]),t._v(" "),a("tr",[a("td",[t._v("S(Sleep)")]),t._v(" "),a("td",[t._v("休眠")])]),t._v(" "),a("tr",[a("td",[t._v("T(Terminated)")]),t._v(" "),a("td",[t._v("停止")])]),t._v(" "),a("tr",[a("td",[t._v("S(Son)")]),t._v(" "),a("td",[t._v("包含子进程")])]),t._v(" "),a("tr",[a("td",[t._v("+")]),t._v(" "),a("td",[t._v("位于后台")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-3-pstree"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-pstree"}},[t._v("#")]),t._v(" 1.3 pstree")]),t._v(" "),a("ul",[a("li",[t._v("pstree [选项]\n"),a("ul",[a("li",[t._v("-p 显示进程 PID")]),t._v(" "),a("li",[t._v("-u 显示进程的所属用户")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-4-top-进程的查看"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-top-进程的查看"}},[t._v("#")]),t._v(" 1.4 top 进程的查看")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("top")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("top")]),t._v(" -b -n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" top.txt\n")])])]),a("h4",{attrs:{id:"_1-4-1-命令选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-1-命令选项"}},[t._v("#")]),t._v(" 1.4.1 命令选项")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("-b")]),t._v(" "),a("td",[t._v("使用批处理模式输出，一般和-n 配合使用")])]),t._v(" "),a("tr",[a("td",[t._v("-n")]),t._v(" "),a("td",[t._v("次数，指定 top 命令执行的次数。一般了-b 选项配合使用")])]),t._v(" "),a("tr",[a("td",[t._v("-d")]),t._v(" "),a("td",[t._v("秒数，指定 top 命令每隔几秒更新。默认是 3 秒")])])])]),t._v(" "),a("h4",{attrs:{id:"_1-4-2-交互模式的命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-2-交互模式的命令"}},[t._v("#")]),t._v(" 1.4.2 交互模式的命令")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("?或 h")]),t._v(" "),a("td",[t._v("显示交互模式的帮助")])]),t._v(" "),a("tr",[a("td",[t._v("P")]),t._v(" "),a("td",[t._v("按 CPU 使用率排序，默认就是此选项")])]),t._v(" "),a("tr",[a("td",[t._v("M")]),t._v(" "),a("td",[t._v("以内存的使用率排序")])]),t._v(" "),a("tr",[a("td",[t._v("N")]),t._v(" "),a("td",[t._v("以 PID 排序")])]),t._v(" "),a("tr",[a("td",[t._v("q")]),t._v(" "),a("td",[t._v("退出 top")])])])]),t._v(" "),a("h4",{attrs:{id:"_1-4-3-状态栏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-3-状态栏"}},[t._v("#")]),t._v(" 1.4.3 状态栏")]),t._v(" "),a("p",[t._v("第一行内容是任务对列信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("内容")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("12:12:12")]),t._v(" "),a("td",[t._v("系统的当前时间")])]),t._v(" "),a("tr",[a("td",[t._v("up 1 day 5:33")]),t._v(" "),a("td",[t._v("系统的运行时间，本机已经运行了 1 天 5 小时 33 分")])]),t._v(" "),a("tr",[a("td",[t._v("2 users")]),t._v(" "),a("td",[t._v("当前登录了二个客户端")])]),t._v(" "),a("tr",[a("td",[t._v("load average 0 0 0")]),t._v(" "),a("td",[t._v("系统在之前 1 分钟、5 分钟、15 分钟的平均负载。一般认为小于 1 小时负载较小，大于 1 超过负载")])])])]),t._v(" "),a("p",[t._v("第二行内容是进程信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("内容")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Tasks: 100 total")]),t._v(" "),a("td",[t._v("系统中的进程总数")])]),t._v(" "),a("tr",[a("td",[t._v("1 running")]),t._v(" "),a("td",[t._v("正在运行的进程数")])]),t._v(" "),a("tr",[a("td",[t._v("94 sleeping")]),t._v(" "),a("td",[t._v("睡眠的进程")])]),t._v(" "),a("tr",[a("td",[t._v("0 stopped")]),t._v(" "),a("td",[t._v("正在停止的进程")])]),t._v(" "),a("tr",[a("td",[t._v("0 zombie")]),t._v(" "),a("td",[t._v("僵尸进程。如果不是 0 的话要进行检查")])])])]),t._v(" "),a("p",[t._v("第三行为 CPU 信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("内容")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Cpu(s): 0.1%us")]),t._v(" "),a("td",[t._v("用户模式占用的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("0.1%sy")]),t._v(" "),a("td",[t._v("系统模式占用的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("0.0%ni")]),t._v(" "),a("td",[t._v("改变过优先级的用户进程 占用的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("99.7%id")]),t._v(" "),a("td",[t._v("空闲 CPU 的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("0.1%wa")]),t._v(" "),a("td",[t._v("等待输入/输出的进程的占用 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("0.1%hi")]),t._v(" "),a("td",[t._v("硬中断请求服务占用的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("0.1%si")]),t._v(" "),a("td",[t._v("软中断请求服务占用的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("0.0%st")]),t._v(" "),a("td",[t._v("st(Steal time)虚拟时间百分比，就是当有")])])])]),t._v(" "),a("p",[t._v("第四行为物理内存信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("内容")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Mem: 1030720k total")]),t._v(" "),a("td",[t._v("物理内存的问题，单位是 KB")])]),t._v(" "),a("tr",[a("td",[t._v("551860k used")]),t._v(" "),a("td",[t._v("已经使用的物理内存数量")])]),t._v(" "),a("tr",[a("td",[t._v("478860k free")]),t._v(" "),a("td",[t._v("空闲的物理内存数量，虚拟机分配了 1024M 内存，使用了 538M,空闲 467M")])]),t._v(" "),a("tr",[a("td",[t._v("43180k buffers")]),t._v(" "),a("td",[t._v("作为缓冲的内存数量，可以存放需要写入硬盘的数据，用来加速数据的写入")])])])]),t._v(" "),a("p",[t._v("第四行为交换分区信息")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("内容")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Swap: 2047992k total")]),t._v(" "),a("td",[t._v("总计的交换分区(虚拟内存)大小")])]),t._v(" "),a("tr",[a("td",[t._v("536k used")]),t._v(" "),a("td",[t._v("已经使用的交换分区大小")])]),t._v(" "),a("tr",[a("td",[t._v("2047456k free")]),t._v(" "),a("td",[t._v("空闲的交换分区大小")])]),t._v(" "),a("tr",[a("td",[t._v("368164k cached")]),t._v(" "),a("td",[t._v("把需要经常读取的数据从硬盘读到内存中，加速了数据的读取")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-5-杀死进程-kill"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-杀死进程-kill"}},[t._v("#")]),t._v(" 1.5 杀死进程(kill)")]),t._v(" "),a("h4",{attrs:{id:"_1-5-1-进程信号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-1-进程信号"}},[t._v("#")]),t._v(" 1.5.1 进程信号")]),t._v(" "),a("p",[a("code",[t._v("kill -l")]),t._v(" 查看可用的进程信号")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("信号代码")]),t._v(" "),a("th",[t._v("信号名称")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("示例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("1")]),t._v(" "),a("td",[t._v("SIGHUP")]),t._v(" "),a("td",[t._v("该信号让进程立即关闭，然后重写读取配置文件后重启,平滑重启")]),t._v(" "),a("td",[t._v("kill -1 -HUP 进程号")])]),t._v(" "),a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[t._v("SIGINT")]),t._v(" "),a("td",[t._v("程序终止信号，用于关闭前台进程,相当于 ctrl+c")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("9")]),t._v(" "),a("td",[t._v("SIGKILL")]),t._v(" "),a("td",[t._v("用来立刻结束程序的运行，本信号不能阻塞、处理和忽略，一般用于强制中止")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("15")]),t._v(" "),a("td",[t._v("SIGTERM")]),t._v(" "),a("td",[t._v("正常结束进程的信号，kill 命令的默认信号。如果不能正常中止，才会尝试 SIGKILL 信号")]),t._v(" "),a("td")])])]),t._v(" "),a("h4",{attrs:{id:"_1-5-2-杀死进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-2-杀死进程"}},[t._v("#")]),t._v(" 1.5.2 杀死进程")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" sleep.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("i")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$i")]),t._v(" -le "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),t._v(" 1s\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("done")]),t._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" sleep.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 后台运行sleep.sh")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" sleep.sh "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询进程号")]),t._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 杀死进程")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" 进程号\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 强行关掉进程，不要轻易使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" -9 进程号\n")])])]),a("h2",{attrs:{id:"_2-系统资源查看"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-系统资源查看"}},[t._v("#")]),t._v(" 2. 系统资源查看")]),t._v(" "),a("h3",{attrs:{id:"_2-1-vmstat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-vmstat"}},[t._v("#")]),t._v(" 2.1 vmstat")]),t._v(" "),a("ul",[a("li",[t._v("监控系统资源使用状态")]),t._v(" "),a("li",[t._v("vmstat [刷新延时 刷新次数]")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vmstat")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\nprocs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----\n r  b   swpd   "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v("   buff  cache   si   so    bi    bo   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("   cs us sy "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),t._v(" wa st\n "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("532")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("329932")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("99388")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("459768")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("81")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("59")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("96")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-1-1-procs-进程信息字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-procs-进程信息字段"}},[t._v("#")]),t._v(" 2.1.1 (procs)进程信息字段")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("procs")]),t._v(" "),a("td",[t._v("r")]),t._v(" "),a("td",[t._v("等待运行的进程数，数量越大，系统就越繁忙")])]),t._v(" "),a("tr",[a("td",[t._v("procs")]),t._v(" "),a("td",[t._v("b")]),t._v(" "),a("td",[t._v("不可被唤醒的进程数量，数量越大，系统越繁忙")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-1-2-memory-内存信息字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-memory-内存信息字段"}},[t._v("#")]),t._v(" 2.1.2 memory(内存信息字段)")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("memory")]),t._v(" "),a("td",[t._v("swpd")]),t._v(" "),a("td",[t._v("使用的 Swap 空间的大小，单位 KB")])]),t._v(" "),a("tr",[a("td",[t._v("memory")]),t._v(" "),a("td",[t._v("free")]),t._v(" "),a("td",[t._v("空闲的内存容量，单位 KB")])]),t._v(" "),a("tr",[a("td",[t._v("memory")]),t._v(" "),a("td",[t._v("buff")]),t._v(" "),a("td",[t._v("缓冲的内存容量，单位 KB")])]),t._v(" "),a("tr",[a("td",[t._v("memory")]),t._v(" "),a("td",[t._v("cache")]),t._v(" "),a("td",[t._v("缓存的内存容量，单位 KB")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-1-3-swap-交换分区信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-swap-交换分区信息"}},[t._v("#")]),t._v(" 2.1.3 swap(交换分区信息)")]),t._v(" "),a("ul",[a("li",[t._v("如果说 si 和 so 数越大说明数据经常要在磁盘和内存之间数据交换，系统性能就会越差")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("swap")]),t._v(" "),a("td",[t._v("si(in)")]),t._v(" "),a("td",[t._v("从磁盘中交换到内存中的数据的数量，单位 KB")])]),t._v(" "),a("tr",[a("td",[t._v("swap")]),t._v(" "),a("td",[t._v("so(out)")]),t._v(" "),a("td",[t._v("从内存中交换到硬盘中的数据的数量，单位 KB")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-1-4-io-磁盘读写"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-4-io-磁盘读写"}},[t._v("#")]),t._v(" 2.1.4 io(磁盘读写)")]),t._v(" "),a("ul",[a("li",[t._v("bi 和 bo 数越大，说明磁盘的 I/O 越繁忙")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("io")]),t._v(" "),a("td",[t._v("bi(in)")]),t._v(" "),a("td",[t._v("从块设备读入数据的问题，单位是块")])]),t._v(" "),a("tr",[a("td",[t._v("io")]),t._v(" "),a("td",[t._v("bo(out)")]),t._v(" "),a("td",[t._v("写到块设备的数据的总量，单位是块")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-1-5-system-系统信息字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-5-system-系统信息字段"}},[t._v("#")]),t._v(" 2.1.5 system(系统信息字段)")]),t._v(" "),a("ul",[a("li",[t._v("in 和 cs 数越大，说明系统与接口设备的通信越繁忙")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("system")]),t._v(" "),a("td",[t._v("in(interrupt)")]),t._v(" "),a("td",[t._v("每秒被中断的进程次数")])]),t._v(" "),a("tr",[a("td",[t._v("system")]),t._v(" "),a("td",[t._v("cs(switch)")]),t._v(" "),a("td",[t._v("每秒钟进行的事件切换次数")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-1-6-cpu-cpu-信息字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-6-cpu-cpu-信息字段"}},[t._v("#")]),t._v(" 2.1.6 CPU(CPU 信息字段)")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("CPU")]),t._v(" "),a("td",[t._v("us(user)")]),t._v(" "),a("td",[t._v("非内核进程消耗 CPU 运算时间的百分比")])]),t._v(" "),a("tr",[a("td",[t._v("CPU")]),t._v(" "),a("td",[t._v("sy(system)")]),t._v(" "),a("td",[t._v("内核进程消耗 CPU 运算时间的百分比")])]),t._v(" "),a("tr",[a("td",[t._v("CPU")]),t._v(" "),a("td",[t._v("id(idea)")]),t._v(" "),a("td",[t._v("空闲 CPU 的百分比")])]),t._v(" "),a("tr",[a("td",[t._v("CPU")]),t._v(" "),a("td",[t._v("wa(wait)")]),t._v(" "),a("td",[t._v("等待 I/O 所消耗的 CPU 百分比")])]),t._v(" "),a("tr",[a("td",[t._v("CPU")]),t._v(" "),a("td",[t._v("st(steal)")]),t._v(" "),a("td",[t._v("被虚拟机偷走的 CPU 百分比")])])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-free"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-free"}},[t._v("#")]),t._v(" 2.2 free")]),t._v(" "),a("ul",[a("li",[t._v("查看内存使用状态")]),t._v(" "),a("li",[t._v("free [-b|-k|-m|-g]")]),t._v(" "),a("li",[t._v("选项\n"),a("ul",[a("li",[t._v("-b 以字节为单位")]),t._v(" "),a("li",[t._v("-k 以 KB 字节为单位")]),t._v(" "),a("li",[t._v("-m 以 MB 字节为单位")]),t._v(" "),a("li",[t._v("-g 以 GB 字节为单位")])])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#free -m")]),t._v("\n              total        used        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("free")]),t._v("      shared  buff/cache   available\nMem:           "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7237")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1494")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3470")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2273")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5439")]),t._v("\nSwap:          "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2047")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2046")]),t._v("\n\n")])])]),a("p",[t._v("第一行")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("total")]),t._v(" "),a("td",[t._v("内存总数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("used")]),t._v(" "),a("td",[t._v("已经使用的内存数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("free")]),t._v(" "),a("td",[t._v("空闲的内存数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("shared")]),t._v(" "),a("td",[t._v("多个进程共享的内存数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("buffers")]),t._v(" "),a("td",[t._v("缓冲区内存数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("cached")]),t._v(" "),a("td",[t._v("缓存内存数")]),t._v(" "),a("td")])])]),t._v(" "),a("p",[t._v("第二行")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("算法")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("- buffers/cache")]),t._v(" "),a("td",[t._v("第一行的 used-buffers-cached")]),t._v(" "),a("td",[t._v("已经使用的要减去缓存和缓冲的内存量")])]),t._v(" "),a("tr",[a("td",[t._v("+ buffers/cache")]),t._v(" "),a("td",[t._v("第一行的 free+buffers+cached")]),t._v(" "),a("td",[t._v("空闲的要加上缓存和缓冲的内存量")])])])]),t._v(" "),a("p",[t._v("第三行")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("分类")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("total")]),t._v(" "),a("td",[t._v("swap 总数，默认单位是 K")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("used")]),t._v(" "),a("td",[t._v("已经使用的 swap 数，默认单位是 K")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("free")]),t._v(" "),a("td",[t._v("空闲的 swap 数，默认单位是 K")]),t._v(" "),a("td")])])]),t._v(" "),a("h3",{attrs:{id:"_2-3-查看内核相关信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-查看内核相关信息"}},[t._v("#")]),t._v(" 2.3 查看内核相关信息")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("uname")]),t._v("\n")])])]),a("h3",{attrs:{id:"_2-4-查看操作系统位数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-查看操作系统位数"}},[t._v("#")]),t._v(" 2.4 查看操作系统位数")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" /bin/ls\n")])])]),a("h3",{attrs:{id:"_2-5-查看发行版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-查看发行版本"}},[t._v("#")]),t._v(" 2.5 查看发行版本")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("lsb_release -a\n")])])]),a("h3",{attrs:{id:"_2-6-查看发行版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-查看发行版本"}},[t._v("#")]),t._v(" 2.6 查看发行版本")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" redhat-lsb -y\nlsb_release -v\n")])])]),a("h2",{attrs:{id:"_3-系统定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-系统定时任务"}},[t._v("#")]),t._v(" 3. 系统定时任务")]),t._v(" "),a("ul",[a("li",[t._v("有些任务比如备份数据库等操作需要在系统空闲的时候执行，比如说每天凌晨备份数据库")])]),t._v(" "),a("h3",{attrs:{id:"_3-1-crontab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-crontab"}},[t._v("#")]),t._v(" 3.1 crontab")]),t._v(" "),a("ul",[a("li",[t._v("可以循环定时执行定时任务")]),t._v(" "),a("li",[t._v("cron")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看cron有没有运行")]),t._v("\nsystemctl restart crond.service\n")])])]),a("h4",{attrs:{id:"_3-1-1-crontab-设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-crontab-设置"}},[t._v("#")]),t._v(" 3.1.1 crontab 设置")]),t._v(" "),a("ul",[a("li",[t._v("crontab [选项]\n"),a("ul",[a("li",[t._v("选项\n"),a("ul",[a("li",[t._v("-e 编辑 crontab 定时任务")]),t._v(" "),a("li",[t._v("-l 查询 crontab 任务")]),t._v(" "),a("li",[t._v("-r 删除当前用户所有的 crontab 任务")])])])])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行任务命令")]),t._v("\n* * * * *  执行的任务\n")])])]),a("ul",[a("li",[t._v("语法")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .---------------- minute (0 - 59)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# |  .------------- hour (0 - 23)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# |  |  .---------- day of month (1 - 31)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# |  |  |  |  |")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# *  *  *  *  * user-name command to be executed")]),t._v("\n")])])]),a("ul",[a("li",[t._v("位置")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("项目")]),t._v(" "),a("th",[t._v("含义")]),t._v(" "),a("th",[t._v("范围")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("第 1 个星")]),t._v(" "),a("td",[t._v("1 个小时中的第几分钟")]),t._v(" "),a("td",[t._v("0~59")])]),t._v(" "),a("tr",[a("td",[t._v("第 2 个星")]),t._v(" "),a("td",[t._v("1 天当中的第几小时")]),t._v(" "),a("td",[t._v("0~23")])]),t._v(" "),a("tr",[a("td",[t._v("第 3 个星")]),t._v(" "),a("td",[t._v("1 月当中的第几天")]),t._v(" "),a("td",[t._v("1~31")])]),t._v(" "),a("tr",[a("td",[t._v("第 4 个星")]),t._v(" "),a("td",[t._v("1 年当中的第几月")]),t._v(" "),a("td",[t._v("1~12")])]),t._v(" "),a("tr",[a("td",[t._v("第 5 个星")]),t._v(" "),a("td",[t._v("1 周当中的星期几")]),t._v(" "),a("td",[t._v("0~6")])])])]),t._v(" "),a("ul",[a("li",[t._v("特殊符号")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("符号")]),t._v(" "),a("th",[t._v("含义")]),t._v(" "),a("th",[t._v("例子")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("*")]),t._v(" "),a("td",[t._v("代表任意时间")]),t._v(" "),a("td",[t._v("比如第一个星就代表一个小时中每分钟都执行一次")])]),t._v(" "),a("tr",[a("td",[t._v(",")]),t._v(" "),a("td",[t._v("代表不连续的时间")]),t._v(" "),a("td",[t._v('比如"1,2,3 ",就代表每小时的 1 分、2 分、3 分执行命令')])]),t._v(" "),a("tr",[a("td",[t._v("-")]),t._v(" "),a("td",[t._v("代表连续的时间范围")]),t._v(" "),a("td",[t._v('比如 " 1-5 * ** ",代表每小时的第 1 分到第 5 分执行命令')])]),t._v(" "),a("tr",[a("td",[t._v("*/n")]),t._v(" "),a("td",[t._v("代表每隔多久执行一次")]),t._v(" "),a("td",[t._v('比如 "/10 " 就代表每隔 10 分钟就执行一次命令')])]),t._v(" "),a("tr",[a("td",[t._v("0 0 1,10 * 1")]),t._v(" "),a("td",[t._v("每月 1 号和 10 号，每周 1 的 0 点 0 分都会执行")]),t._v(" "),a("td")])])]),t._v(" "),a("ul",[a("li",[t._v("实践")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("符号")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("10 22 * * *")]),t._v(" "),a("td",[t._v("在每天的 22 点 10 分执行")])]),t._v(" "),a("tr",[a("td",[t._v("0 15 1 * *")]),t._v(" "),a("td",[t._v("每周 1 的 15 点 0 分执行")])]),t._v(" "),a("tr",[a("td",[t._v("0 5 5,10 *")]),t._v(" "),a("td",[t._v("每月 5 号和 10 号的凌晨 5 点整执行")])]),t._v(" "),a("tr",[a("td",[t._v("10 5 * * 1-5")]),t._v(" "),a("td",[t._v("每周一到周五的凌晨 5 点 10 分执行命令")])]),t._v(" "),a("tr",[a("td",[t._v("/10 10 * * *")]),t._v(" "),a("td",[t._v("每天凌晨 10 点钟，每隔 10 分钟执行一次")])])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("crontab")]),t._v(" -e\n* * * * * "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" /root/date.log "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#每天写入时间")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[t._v("注意")]),t._v(" "),a("ul",[a("li",[t._v("所有选项不能为空，必须填写")]),t._v(" "),a("li",[t._v("crontab 最小单位是分钟,最大单位是天")]),t._v(" "),a("li",[t._v("不管写命令还是脚本都要使用绝对路径")])])])]),t._v(" "),a("h3",{attrs:{id:"_3-2-系统定时任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-系统定时任务"}},[t._v("#")]),t._v(" 3.2 系统定时任务")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("crontab -e")]),t._v("是用户执行的命令，不同的用户身份可以执行自己的定时任务")]),t._v(" "),a("li",[t._v("如果需要系统执行定时任务，可以编辑"),a("code",[t._v("/etc/crontab")]),t._v("文件")]),t._v(" "),a("li",[a("code",[t._v("/etc/crontab")]),t._v("可以指定 shell、路径、邮件发送和家目录")])]),t._v(" "),a("h4",{attrs:{id:"_3-2-1-etc-crontab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-etc-crontab"}},[t._v("#")]),t._v(" 3.2.1 /etc/crontab")]),t._v(" "),a("ul",[a("li",[t._v("修改"),a("code",[t._v("/etc/crontab")]),t._v("配置文件")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" * * * "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" /root/date.log\n")])])]),a("h2",{attrs:{id:"_4-实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-实践"}},[t._v("#")]),t._v(" 4. 实践")]),t._v(" "),a("ul",[a("li",[t._v("监控 nginx")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /root/nginxps.sh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 本地变量nginx")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 反引号``包裹的都是命令，可以查询到nginx进程数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("nginx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" nginx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" -v "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${nginx}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${nginx}")]),t._v(" -gt "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nginx is running'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'nginx准备重启'")]),t._v("\n/bin/systemctl start nginx.service\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 让nginxps可执行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" +x nginxps.sh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("crontab")]),t._v(" -e\n* * * * * /root/nginxps.sh\n")])])]),a("ul",[a("li",[t._v("监控 mysql 状态")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" root/mysqlps.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/sh")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PortNum")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" -lnt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PortNum")]),t._v(" -eq "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqld is running."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysqld is stoped."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n")])])]),a("ul",[a("li",[t._v("mysql 备份")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" root/mysql_backup.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/bash")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),t._v(" +%F_%H-%M-%S"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("HOST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DB")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("test\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PASS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("abcd1"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#EFG")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MAIL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxx@qq.com"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BACKUP_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/data/db_backup\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" -d "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BACKUP_DIR")]),t._v('"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BACKUP_DIR")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("SQL_FILE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${DB}")]),t._v("_FULL_"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DATE")]),t._v(".sql\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BAK_FILE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${DB}")]),t._v("_FULL_"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DATE")]),t._v(".zip\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BACKUP_DIR")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" mysqldump -h"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$HOST")]),t._v(" -u"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$USER")]),t._v(" -p"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PASS")]),t._v(" -B "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SQL_FILE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("zip")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BAK_FILE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SQL_FILE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SQL_FILE")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" -s "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BAK_FILE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DATE")]),t._v(' 备份失败"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mail -s "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"备份失败"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MAIL")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DATE")]),t._v(' 备份失败"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mail -s "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"备份失败"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$MAIL")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$BACKUP_DIR")]),t._v(" -name "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*.zip'")]),t._v(" -ctime +14 -exec "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 测试脚本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" -x /root/mysql_backup.sh\n")])])])])}),[],!1,null,null,null);s.default=_.exports}}]);